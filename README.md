# Poromet - 細孔サイズ分析ツール

FastAPIバックエンドとNext.jsフロントエンドを組み合わせた、PoreSpyライブラリを使用したWebベースの細孔サイズ分析ツールです。

## 🔬 特徴

- **画像アップロード**: ドラッグ＆ドロップでSEM画像をアップロード
- **パラメータ調整**: 倍率、直径制限、閾値設定などを調整可能
- **リアルタイム解析**: 処理中の進捗を視覚的に表示
- **結果の可視化**: 統計サマリーと分布プロット
- **データエクスポート**: 解析結果をZIPファイルでダウンロード
- **実際の細孔解析**: PoreSpyライブラリによる本格的な解析
- **正確な測定**: 実際の細孔径測定とサイズ分布計算
- **詳細な結果**: 平均・最頻直径、細孔率、検出細孔数
- **完全な出力**: ヒストグラム、細孔マップ、統計データ
- **日本語対応**: 完全に日本語化されたインターフェース

## 🚀 クイックスタート

### 前提条件

- Python 3.8以上
- Node.js 16以上
- pip（Pythonパッケージマネージャー）
- npmまたはyarn（Node.jsパッケージマネージャー）

### セットアップ手順

1. **リポジトリのクローン**
   ```bash
   git clone https://github.com/your-username/PorometGUI.git
   cd PorometGUI
   ```

2. **バックエンドの依存関係をインストール**
   ```bash
   cd backend
   pip install -r requirements.txt
   ```

3. **フロントエンドの依存関係をインストール**
   ```bash
   cd ..
   npm install
   ```

### アプリケーションの起動

1. **バックエンドサーバーの起動**
   ```bash
   cd backend
   uvicorn main:app --reload
   ```
   
   または、`start_backend.py`を使用:
   ```bash
   python start_backend.py
   ```

2. **フロントエンド開発サーバーの起動**（別のターミナルで）
   ```bash
   npm run dev
   ```

3. **アプリケーションにアクセス**
   - フロントエンド: http://localhost:3000
   - APIドキュメント: http://127.0.0.1:8000/docs

## 🐳 Dockerを使用したデプロイ

```bash
docker-compose up -d --build
```

## 📊 対応画像・倍率

### 対応画像形式
- JPEG, PNG, TIFF
- グレースケール画像を推奨
- SEM画像に最適化

### 推奨設定
- **閾値補正倍率**: 1.8 (Otsu閾値の補正)
- **最大直径**: 80nm (解析する細孔の上限サイズ)

## 🔧 解析プロセス

1. **画像読み込み**: SEM画像のアップロード
2. **前処理**: グレースケール変換とノイズ除去
3. **セグメンテーション**: Otsu閾値による細孔領域の抽出
4. **細孔解析**: PoreSpyによる細孔サイズ測定
5. **統計計算**: 平均・最頻直径、分布の計算
6. **結果出力**: ヒストグラム、マップ、データファイル

## 📈 出力結果

### 統計情報:
- 平均直径 (nm)
- 最頻直径 (nm)
- 細孔率 (%)
- 検出細孔数

### 出力ファイル:
- 細孔サイズ分布ヒストグラム (PNG)
- 細孔サイズマップ (PNG)
- 元画像・閾値処理画像 (PNG)
- 統計データ (CSV, TXT)

## ⚠️ 注意事項

- 実際の解析には時間がかかります（画像サイズに依存）
- 高解像度画像ほど処理時間が長くなります
- メモリ使用量が大きくなる場合があります

## 🐛 トラブルシューティング

### バックエンドが起動しない場合:
```bash
pip install --upgrade -r backend/requirements.txt
```

### 解析が失敗する場合:
- 画像形式を確認 (JPEG, PNG, TIFF)
- 倍率と解像度の組み合わせを確認
- 閾値補正倍率を調整 (0.5-3.0の範囲)

## 🤝 貢献について

バグの報告や機能の要望は、GitHubのIssueからお願いします。プルリクエストも歓迎します。

## 📝 ライセンス

[MIT License](LICENSE)
